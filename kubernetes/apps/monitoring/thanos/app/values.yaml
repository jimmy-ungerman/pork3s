image:
  registry: quay.io
  repository: thanos/thanos
  tag: v0.32.5
existingObjstoreSecret: thanos-objstore-secret
queryFrontend:
  enabled: true
  replicaCount: 3
  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:      
      external-dns.alpha.kubernetes.io/target: porkboi.io
      external-dns.alpha.kubernetes.io/hostname: thanos.porkboi.io
      nginx.ingress.kubernetes.io/auth-method: GET
      nginx.ingress.kubernetes.io/auth-url: http://authelia.default.svc.cluster.local/api/verify
      nginx.ingress.kubernetes.io/auth-signin: https://auth.porkboi.io?rm=$request_method
      nginx.ingress.kubernetes.io/auth-response-headers: Remote-User,Remote-Name,Remote-Groups,Remote-Email
      nginx.ingress.kubernetes.io/auth-snippet: |
        proxy_set_header X-Forwarded-Method $request_method;
    hostname: &host thanos.porkboi.io
    tls: true
    extraTls:
      - hosts:
          - *host
query:
  enabled: true
  replicaCount: 3
  replicaLabel: ["__replica__"]
  dnsDiscovery:
    sidecarsService: kube-prometheus-stack-thanos-discovery
    sidecarsNamespace: monitoring
bucketweb:
  enabled: true
  replicaCount: 3
compactor:
  enabled: true
  extraFlags:
    - --compact.concurrency=4
    - --delete-delay=30m
  retentionResolutionRaw: 14d
  retentionResolution5m: 14d
  retentionResolution1h: 14d
  persistence:
    enabled: true
    storageClass: rook-ceph-block
    size: 20Gi
storegateway:
  enabled: true
  replicaCount: 3
  persistence:
    enabled: true
    storageClass: rook-ceph-block
    size: 20Gi
ruler:
  enabled: true
  replicaCount: 3
  replicaLabel: __replica__
  alertmanagers: ["http://kube-prometheus-stack-alertmanager.monitoring.svc.cluster.local:9093"]
  extraFlags: ["--web.prefix-header=X-Forwarded-Prefix"]
  config: |-
    groups:
      - name: PrometheusWatcher
        rules:
          - alert: PrometheusDown
            annotations:
              summary: A Prometheus has disappeared from Prometheus target discovery
            expr: absent(up{job="kube-prometheus-stack-prometheus"})
            for: 5m
            labels:
              severity: critical
  persistence:
    enabled: true
    storageClass: rook-ceph-block
    size: 20Gi
metrics:
  enabled: true
  serviceMonitor:
    enabled: true